-- table to store users information
CREATE TABLE Users (
    UserID INT PRIMARY KEY IDENTITY(1,1),
    Username NVARCHAR(50) UNIQUE NOT NULL,
    [Password] NVARCHAR(255) NOT NULL,
    Email NVARCHAR(100) UNIQUE NOT NULL,
    ProfilePic VARBINARY(MAX) NULL
);
--main table
CREATE TABLE VideoUploads (
    VideoID INT PRIMARY KEY IDENTITY(1,1),
    UserID INT,
    VideoTitle NVARCHAR(100) NOT NULL,
    UploadDate DATETIME DEFAULT GETDATE(),
	Duration INT,
    TimeLimit INT, -- in minutes, adjust as needed
    Price DECIMAL(10, 2),
    VideoImage VARBINARY(MAX),
	Genre NVARCHAR (50) null,
    CONSTRAINT FK_User_VideoUploads FOREIGN KEY (UserID) REFERENCES Users(UserID) ON DELETE CASCADE
);
-- table to store video information
CREATE TABLE VideoRentals (
    RentalID INT PRIMARY KEY IDENTITY(1,1),
    VideoID INT,
    UserID INT,
    VideoTitle NVARCHAR(100) NOT NULL,
    RentalDate DATETIME DEFAULT GETDATE(),
    TimeLimit INT,
    ReturnDate AS DATEADD(MINUTE, TimeLimit, RentalDate) PERSISTED,
    Status NVARCHAR(50) DEFAULT 'Pending',
    CONSTRAINT FK_Video_VideoRentals FOREIGN KEY (VideoID) REFERENCES VideoUploads(VideoID) ON DELETE NO ACTION,
    CONSTRAINT FK_User_VideoRentals FOREIGN KEY (UserID) REFERENCES Users(UserID) ON DELETE NO ACTION
);